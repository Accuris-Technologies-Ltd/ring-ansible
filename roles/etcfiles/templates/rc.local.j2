#!/bin/sh -e
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will "exit 0" on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

{% if ansible_virtualization_role|default(None) == "guest" and ansible_virtualization_type|default(None) == "openvz" %}
# Override hostname. Some VM systems (OpenVZ) mess this up
echo "{{ ansible_nodename }}" > /etc/hostname
hostname -F /etc/hostname
{% endif %}

exit 0
